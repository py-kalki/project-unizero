---
phase: 03-ai-discovery-core
plan: '02'
type: execute
wave: 1
depends_on: []
files_modified:
  - src/lib/services/tool.service.ts
  - src/types/tools.ts
autonomous: true
user_setup: []

must_haves:
  truths:
    - 'Tool service provides search by name/description'
    - 'Tool service provides filter by category slug'
    - 'Tool service provides filter by pricing type'
    - 'Tool service supports pagination'
    - 'Tool service can fetch single tool by slug'
  artifacts:
    - path: 'src/lib/services/tool.service.ts'
      provides: 'Tool business logic with search/filter/pagination'
      exports: 'getTools, getToolBySlug'
    - path: 'src/types/tools.ts'
      provides: 'TypeScript types for tools'
      contains: 'ToolFilters, ToolSearchParams'
  key_links:
    - from: 'src/lib/services/tool.service.ts'
      to: 'prisma'
      via: 'Prisma queries'
      pattern: "prisma\\.aiTool"
---

<objective>
Create tool service layer with search, filter, and pagination capabilities. Implements URL-driven search/filter pattern using Prisma with Next.js 15 async searchParams compatibility.
</objective>

<execution_context>
@C:/Users/ASUS/.config/opencode/get-shit-done/workflows/execute-plan.md
@C:/Users/ASUS/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/03-ai-discovery-core/03-RESEARCH.md
@prisma/schema.prisma
</context>

<tasks>

<task type="auto">
  <name>Create tool types</name>
  <files>src/types/tools.ts</files>
  <action>
    Create src/types/tools.ts:
    1. Define ToolWithCategory type (AITool with category relation)
    2. Define ToolFilters type with query, category, pricing, page, perPage
    3. Define GetToolsResult type with tools[], total, page, perPage
    4. Export pricing label helper type
  </action>
  <verify>TypeScript compilation passes with no errors</verify>
  <done>Types file exists with proper ToolFilters, ToolWithCategory, GetToolsResult types</done>
</task>

<task type="auto">
  <name>Create tool service with search and filter logic</name>
  <files>src/lib/services/tool.service.ts</files>
  <action>
    Create src/lib/services/tool.service.ts:
    1. Import prisma client from @/lib/db/client
    2. Create getTools() function accepting {query, category, pricing, page, perPage}
    3. Build Prisma where clause:
       - query: OR on name/description with contains + mode: 'insensitive'
       - category: filter by category.slug
       - pricing: filter by pricingType
    4. Use Promise.all for parallel findMany and count
    5. Include category in results, order by name asc
    6. Add skip/take for pagination
    7. Create getToolBySlug() function for single tool lookup
    
    Reference: 03-RESEARCH.md lines 193-242 for implementation pattern
  </action>
  <verify>TypeScript compilation passes, service can be imported</verify>
  <done>Service exports getTools() and getToolBySlug() functions</done>
</task>

</tasks>

<verification>
1. Import service in a test file and verify types work
2. Verify getTools() accepts all filter parameters
3. Verify getToolBySlug() returns tool with category relation
</verification>

<success_criteria>

- Tool service exports getTools() with search, category filter, pricing filter, pagination
- Tool service exports getToolBySlug() for detail page
- All Prisma queries use proper indexes (categoryId, pricingType)
  </success_criteria>

<output>
After completion, create `.planning/phases/03-ai-discovery-core/{phase}-02-SUMMARY.md`
</output>
